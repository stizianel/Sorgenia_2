<root>
	<queries>
	<qpriGasAggregator>
		<mainSelect ><![CDATA[
       select v.cncon,    --0
        v.cncon,                                       --1
        a.operando,                                    --2    
        -- to_char(v.cdsti,'yyyymmdd'),--3                           --3 
        '20090701',
        data_validita_al,                              --4
        valori,                                        --5
        nvl(prezzo,0),                                 --6
        b.id_operando ,                                 --7  
        tipo ,                                        --8      
        v.cncon||a.operando                         --9    
        from DBI_USER.IFC_SAP_ANAGRCONTRGAS  v, z_prodotto_operando a, z_anagrafica_operandi b
        where a.ctar1=v.ctar1
        and v.cncon IN (SELECT CNCON FROM Z_pr_in_lavorazione_gas)
        and a.operando = b.operando
        and tipo ='QPRICE'
        group by 
        v.cncon, 
        v.cncon, 
        a.operando, 
        to_char(v.cdsti,'yyyymmdd'),--3,
        data_validita_al, 
        valori, 
        nvl(prezzo,0),b.id_operando,tipo
        order by  v.cncon||a.operando 
        ]]></mainSelect>
		
		<insertTable name='GAS_FACTS_KEY' truncate = 'False'  break_index='0'    >
		     <field name='LEGACY' index='0' />
		     <field name='TIPO'  constant_value='KEY' />
		     <field name='ANLAGE' index='1' />
		     <field name='BIS'  index='4' />
		   </insertTable> 
		     <insertTable name='GAS_FACTS_F_QPRICE' truncate = 'True' break_index='9' >
		     <field name='LEGACY' index='0' />
		     <field name='TIPO' constant_value='F_QPRI' />
		     <field name='OPERAND' index = '2'  />
		     <field name='SAISON' constant_value='' />
		     <field name='PROG'   index='7' />
		   </insertTable> 
		   <insertTable name='GAS_FACTS_V_QPRICE' truncate = 'True' break_index='' >
		     <field name='LEGACY' index='0' />
		     <field name='TIPO' constant_value='V_QPRI' />
		     <field name='AB' index='3' />
		     <field name='BIS' index='4' />
		     <field name='PREIS' index='5' />
		     <field name='PRSBTR' index='6' />
		     <field name='WAERS' constant_value='' />
		     <field name='TARIFART' constant_value='' />
		     <field name='KONDGIR' constant_value='' />
		     <field name='PROG'    index='7' />   
		     </insertTable> 
		
	</qpriGasAggregator>
	 <FactQpriGasExtractor>
		<mainSelect ><![CDATA[
		 SELECT
               FACTS_KEY.LEGACY,  --0
               FACTS_KEY.TIPO,--1
               FACTS_KEY.ANLAGE, --2
               FACTS_KEY.BIS, --3
               facts_f_qprice.legacy, --4
               facts_f_qprice.tipo,  --5
               facts_f_qprice.operand, --6
               facts_f_qprice.saison, --7
               facts_f_qprice.prog, --8
               facts_v_qprice.legacy, --9
               facts_v_qprice.tipo, --10
               facts_v_qprice.ab, --11
               facts_v_qprice.bis, --12
               facts_v_qprice.preis, --13
               facts_v_qprice.prsbtr, --14
               facts_v_qprice.waers, --15
               facts_v_qprice.tarifart, --16
               facts_v_qprice.kondgir, --17
               facts_v_qprice.prog --18
              from facts_key,facts_f_qprice,facts_v_qprice
              where facts_key.legacy = facts_f_qprice.legacy
              and facts_v_qprice.legacy=facts_key.legacy
              and facts_f_qprice.legacy=facts_v_qprice.legacy
              and facts_f_qprice.prog=facts_v_qprice.prog
              order by facts_f_qprice.prog
        ]]></mainSelect>
         <csvLine line_index='00' break_index='0'  field_start_index='0'  field_end_index='3' >
          </csvLine>
         <csvLine line_index='01' break_index=''   field_start_index='4'  field_end_index='7'   >
         </csvLine>       
         <csvLine line_index='02' break_index=''   field_start_index='9'  field_end_index='17'  >
         </csvLine>   
         <ende field_index='0' />
	</FactQpriGasExtractor>
	
	
	</queries>
</root>

