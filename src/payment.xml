<root>
	<queries>
    <PaymentAggregator>
         <mainSelect ><![CDATA[
       select b.cd_entita_fatt||'-'|| B.CUSTOMER_TRX_ID --0
       ,to_char(c.gl_date, 'YYYYMMDD'), --1
       TO_CHAR(SYSDATE, 'YYYYMMDD'), --2 
       b.amount_due_original,        --3
       TO_CHAR(c.due_date, 'YYYYMMDD'), --4
       amount, --5
       c.cash_receipt_id, --6
       c.receipt_number,
       b.trx_date,
       b.due_date,
       b.document_status,
       b.competence_date,
       b.amount_due_original,
       b.amount_due_remaining,
       c.receipt_date,
       c.status,
       c.confirmed_flag,
       c.amount_applied
  from 
       dbi_user.wrk_oa_documents b,
       dbi_user.wrk_oa_payments  c,
       document_fkkko k
 where 
   b.account_number = c.account_number
   and b.customer_trx_id = c.customer_trx_id
   and b.cd_entita_fatt||'-'|| B.CUSTOMER_TRX_ID = k.legacy
   order by b.account_number, b.customer_trx_id
     ]]></mainSelect>
    <insertTable name='EMIG_PAY_FKKKO' truncate = 'True' break_index='0' >
             <field name='OIBEL'  index='0' />
             <field name='LEGACY' index='6' />
		     <field name='TIPO' constant_value='FKKKO' />
		     <field name='BLDAT' index='1' />
		     <field name='BUDAT' index='2' /> 
		     <field name='HERKF' constant_value='RZ' /> 
		     <field name='AUGRD' constant_value='01' />
	</insertTable> 
 <insertTable name='EMIG_PAY_FKKOPK' truncate = 'True' break_index='0' >
 			 <field name='LEGACY' index='6' />
		     <field name='TIPO'  constant_value='FKKOPK' />
             <field name='BUKRS'  constant_value='SORG' />
		     <field name='HKONT'  constant_value='999997' />
		     <field name='BETRW'  index='3' />
		     <field name='VALUT'  index='4' />     
		     <field name='SGTXT'  index='5' />
	</insertTable> 
	 </PaymentAggregator> 
	 
	<PaymentExtractor>
		<mainSelect ><![CDATA[
		 SELECT
		   EMIG_PAY_FKKKO.LEGACY, --0
		   EMIG_PAY_FKKKO.TIPO, --1
		   EMIG_PAY_FKKKO.HERKF, --2
		   EMIG_PAY_FKKKO.BLDAT, --3
		   EMIG_PAY_FKKKO.BUDAT, --4
		   EMIG_PAY_FKKKO.OIBEL, --5
		   EMIG_PAY_FKKKO.AUGRD, --6
		   EMIG_PAY_FKKOPK.LEGACY, --7
		   EMIG_PAY_FKKOPK.TIPO, --8
		   EMIG_PAY_FKKOPK.BUKRS, --9
		   EMIG_PAY_FKKOPK.HKONT, --10
		   EMIG_PAY_FKKOPK.VALUT, --11
		   EMIG_PAY_FKKOPK.BETRW, --12
		   EMIG_PAY_FKKOPK.SGTXT --13
		  FROM EMIG_PAY_FKKKO,
		       EMIG_PAY_FKKOPK
		   WHERE EMIG_PAY_FKKKO.LEGACY=EMIG_PAY_FKKOPK.LEGACY
		 ORDER BY EMIG_PAY_FKKKO.LEGACY
		 ]]></mainSelect>
         <csvLine line_index='00' break_index='0' field_start_index='0' field_end_index='6' >
         </csvLine>
         <csvLine line_index='01' break_index='' field_start_index='7' field_end_index='13' >
         </csvLine>  
         <ende field_index='0' />
	</PaymentExtractor>     
		 	  
	</queries>
</root>  